(self.webpackChunkcap=self.webpackChunkcap||[]).push([[230],{230:(t,e,i)=>{"use strict";i.r(e),i.d(e,{StopListPageModule:()=>Y});var o=i(1116),s=i(1041),n=i(5394),c=i(3146),r=i(4762),l=i(8194),p=i(9609),h=i(5614),d=i(5724),a=i(8579);function u(t,e){if(1&t&&(h.TgZ(0,"div",32),h.TgZ(1,"div",14),h._UZ(2,"div",15),h.qZA(),h.TgZ(3,"p",16),h._uU(4),h.qZA(),h.qZA()),2&t){const t=e.$implicit;h.Q6J("ngClass",5==t.XSTATUS_0?"isSkip":"todo-steps"),h.xp6(4),h.Oqu(t.XCSGNUM_0)}}function g(t,e){if(1&t){const t=h.EpF();h.TgZ(0,"ion-button",33),h.NdJ("click",function(){return h.CHM(t),h.oxw(2).checkIn()}),h.TgZ(1,"ion-label"),h._uU(2,"Check In"),h.qZA(),h.qZA()}}function Z(t,e){if(1&t&&(h.TgZ(0,"ion-chip",34),h._UZ(1,"ion-icon",35),h.TgZ(2,"ion-label"),h._uU(3),h.ALo(4,"date"),h.qZA(),h.qZA()),2&t){const t=h.oxw(2);h.xp6(3),h.Oqu(h.xi3(4,1,t.checkedModel.checkedIn,"dd-MM-yyyy HH:mm"))}}function T(t,e){1&t&&(h.TgZ(0,"ion-chip",43),h.TgZ(1,"ion-label"),h._uU(2,"Skipped"),h.qZA(),h._UZ(3,"ion-icon",44),h.qZA())}function _(t,e){if(1&t){const t=h.EpF();h.TgZ(0,"ion-card",36),h.NdJ("click",function(){const e=h.CHM(t).$implicit;return h.oxw(2).stopDetails(e.XDOCNUM_0,e.XCSGNUM_0)}),h.TgZ(1,"ion-card-content",37),h.TgZ(2,"ion-grid",38),h.TgZ(3,"ion-row"),h._UZ(4,"ion-col",22),h.TgZ(5,"ion-col",39),h.TgZ(6,"ion-card-subtitle",40),h._uU(7),h._UZ(8,"br"),h._uU(9),h._UZ(10,"br"),h._uU(11),h.qZA(),h.TgZ(12,"ion-label"),h.TgZ(13,"p",41),h._uU(14),h.qZA(),h.qZA(),h.YNc(15,T,4,0,"ion-chip",42),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA()}if(2&t){const t=e.$implicit;h.xp6(7),h.hij("",t.XBPCORD_0," "),h.xp6(2),h.hij(" ",t.XBPNAME_0," "),h.xp6(2),h.hij(" ",t.XCTY_0?t.XCTY_0:"-"," "),h.xp6(3),h.Oqu(t.XDOCNUM_0),h.xp6(1),h.Q6J("ngIf",5==t.XSTATUS_0)}}function A(t,e){if(1&t){const t=h.EpF();h.TgZ(0,"ion-button",33),h.NdJ("click",function(){return h.CHM(t),h.oxw(2).checkOut()}),h.TgZ(1,"ion-label"),h._uU(2,"Check Out"),h.qZA(),h.qZA()}}function S(t,e){if(1&t&&(h.TgZ(0,"ion-chip",45),h._UZ(1,"ion-icon",35),h.TgZ(2,"ion-label"),h._uU(3),h.ALo(4,"date"),h.qZA(),h.qZA()),2&t){const t=h.oxw(2);h.xp6(3),h.Oqu(h.xi3(4,1,t.todoStops[0].XCKOTDAT_0,"dd-MM-yyyy HH:mm"))}}function f(t,e){if(1&t&&(h.TgZ(0,"div",11),h.TgZ(1,"div",12),h.TgZ(2,"div",13),h.TgZ(3,"div",14),h._UZ(4,"div",15),h.qZA(),h.TgZ(5,"p",16),h._UZ(6,"img",17),h.qZA(),h.qZA(),h.YNc(7,u,5,2,"div",18),h.TgZ(8,"div",19),h.TgZ(9,"div",14),h._UZ(10,"div",15),h.qZA(),h.TgZ(11,"p",16),h._UZ(12,"img",20),h.qZA(),h.qZA(),h.qZA(),h.TgZ(13,"ion-card"),h.TgZ(14,"ion-card-content",21),h.TgZ(15,"ion-grid"),h.TgZ(16,"ion-row"),h._UZ(17,"ion-col",22),h.TgZ(18,"ion-col",23),h.TgZ(19,"ion-item",24),h._UZ(20,"ion-icon",25),h.TgZ(21,"ion-label",26),h.TgZ(22,"h2",27),h.TgZ(23,"b"),h._uU(24),h.qZA(),h.qZA(),h.TgZ(25,"p"),h._uU(26),h.qZA(),h.YNc(27,g,3,0,"ion-button",28),h.YNc(28,Z,5,4,"ion-chip",29),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.YNc(29,_,16,5,"ion-card",30),h.TgZ(30,"ion-card"),h.TgZ(31,"ion-card-content",21),h.TgZ(32,"ion-grid"),h.TgZ(33,"ion-row"),h._UZ(34,"ion-col",22),h.TgZ(35,"ion-col",23),h.TgZ(36,"ion-item",24),h._UZ(37,"ion-icon",25),h.TgZ(38,"ion-label",26),h.TgZ(39,"h2",27),h.TgZ(40,"b"),h._uU(41),h.qZA(),h.qZA(),h.TgZ(42,"p"),h._uU(43),h.qZA(),h.YNc(44,A,3,0,"ion-button",28),h.YNc(45,S,5,4,"ion-chip",31),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&t){const t=h.oxw();h.xp6(7),h.Q6J("ngForOf",t.todoStops),h.xp6(17),h.Oqu(t.todoStops[0].XSTOFCY_0),h.xp6(2),h.Oqu(t.todoStops[0].XFCYDES_0),h.xp6(1),h.Q6J("ngIf",!t.isCheckedIn),h.xp6(1),h.Q6J("ngIf",t.isCheckedIn),h.xp6(1),h.Q6J("ngForOf",t.todoStops),h.xp6(12),h.Oqu(t.todoStops[0].XSTOFCY_0),h.xp6(2),h.Oqu(t.todoStops[0].XFCYDES_0),h.xp6(1),h.Q6J("ngIf",!t.isCheckedOut),h.xp6(1),h.Q6J("ngIf",t.isCheckedOut)}}function C(t,e){if(1&t&&(h.TgZ(0,"div",47),h.TgZ(1,"div",14),h._UZ(2,"div",15),h.qZA(),h.TgZ(3,"p",16),h._uU(4),h.qZA(),h.qZA()),2&t){const t=e.$implicit;h.xp6(4),h.Oqu(t.XCSGNUM_0)}}function v(t,e){1&t&&(h.TgZ(0,"ion-chip",43),h.TgZ(1,"ion-label"),h._uU(2,"In Progress"),h.qZA(),h.qZA())}function q(t,e){if(1&t){const t=h.EpF();h.TgZ(0,"ion-card",36),h.NdJ("click",function(){const e=h.CHM(t).$implicit;return h.oxw(2).stopDetails(e.XDOCNUM_0,e.XCSGNUM_0)}),h.TgZ(1,"ion-card-content",48),h.TgZ(2,"ion-grid",38),h.TgZ(3,"ion-row"),h._UZ(4,"ion-col",22),h.TgZ(5,"ion-col",39),h.TgZ(6,"ion-card-subtitle",40),h._uU(7),h._UZ(8,"br"),h._uU(9),h._UZ(10,"br"),h._uU(11),h.qZA(),h.TgZ(12,"ion-label"),h.TgZ(13,"p",41),h._uU(14),h.qZA(),h.qZA(),h.YNc(15,v,3,0,"ion-chip",42),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA()}if(2&t){const t=e.$implicit;h.xp6(7),h.hij("",t.XBPCORD_0," "),h.xp6(2),h.hij(" ",t.XBPNAME_0," "),h.xp6(2),h.hij(" ",t.XCTY_0?t.XCTY_0:"-"," "),h.xp6(3),h.Oqu(t.XDOCNUM_0),h.xp6(1),h.Q6J("ngIf",2==t.XISACTIVDOC_0||" "==t.XDEPTIM_0)}}function M(t,e){if(1&t&&(h.TgZ(0,"div",11),h.TgZ(1,"div",12),h.YNc(2,C,5,1,"div",46),h.qZA(),h.YNc(3,q,16,5,"ion-card",30),h.qZA()),2&t){const t=h.oxw();h.xp6(2),h.Q6J("ngForOf",t.activeStops),h.xp6(1),h.Q6J("ngForOf",t.activeStops)}}function O(t,e){if(1&t&&(h.TgZ(0,"div",47),h.TgZ(1,"div",14),h._UZ(2,"div",15),h.qZA(),h.TgZ(3,"p",16),h._uU(4),h.qZA(),h.qZA()),2&t){const t=e.$implicit;h.xp6(4),h.Oqu(t.XCSGNUM_0)}}function b(t,e){if(1&t){const t=h.EpF();h.TgZ(0,"ion-button",33),h.NdJ("click",function(){return h.CHM(t),h.oxw(2).checkIn()}),h.TgZ(1,"ion-label"),h._uU(2,"Check In"),h.qZA(),h.qZA()}}function w(t,e){if(1&t&&(h.TgZ(0,"ion-chip",34),h._UZ(1,"ion-icon",35),h.TgZ(2,"ion-label"),h._uU(3),h.ALo(4,"date"),h.qZA(),h.qZA()),2&t){const t=h.oxw(2);h.xp6(3),h.Oqu(h.xi3(4,1,null==t.checkedModel?null:t.checkedModel.checkedIn,"dd-MM-yyyy HH:mm"))}}function m(t,e){if(1&t&&(h.TgZ(0,"ion-chip",51),h._UZ(1,"ion-icon",35),h.TgZ(2,"ion-label"),h._uU(3),h.ALo(4,"date"),h.qZA(),h.qZA()),2&t){const t=h.oxw().$implicit;h.xp6(3),h.Oqu(h.xi3(4,1,t.DLDATTIM,"dd-MM-yyyy HH:mm"))}}function U(t,e){if(1&t){const t=h.EpF();h.TgZ(0,"ion-card",36),h.NdJ("click",function(){const e=h.CHM(t).$implicit;return h.oxw(2).stopDetails(e.XDOCNUM_0,e.XCSGNUM_0)}),h.TgZ(1,"ion-card-content",48),h.TgZ(2,"ion-grid",38),h.TgZ(3,"ion-row"),h._UZ(4,"ion-col",22),h.TgZ(5,"ion-col",39),h.TgZ(6,"ion-card-subtitle",40),h._uU(7),h._UZ(8,"br"),h._uU(9),h._UZ(10,"br"),h._uU(11),h.qZA(),h.TgZ(12,"ion-label"),h.TgZ(13,"p",41),h._uU(14),h.qZA(),h.qZA(),h.YNc(15,m,5,4,"ion-chip",50),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA()}if(2&t){const t=e.$implicit;h.xp6(7),h.hij("",t.XBPCORD_0," "),h.xp6(2),h.hij(" ",t.XBPNAME_0," "),h.xp6(2),h.hij(" ",t.XCTY_0?t.XCTY_0:"-"," "),h.xp6(3),h.Oqu(t.XDOCNUM_0),h.xp6(1),h.Q6J("ngIf",6==t.XSTATUS_0)}}function P(t,e){if(1&t){const t=h.EpF();h.TgZ(0,"ion-button",33),h.NdJ("click",function(){return h.CHM(t),h.oxw(2).checkOut()}),h.TgZ(1,"ion-label"),h._uU(2,"Check Out"),h.qZA(),h.qZA()}}function D(t,e){if(1&t&&(h.TgZ(0,"ion-chip",45),h._UZ(1,"ion-icon",35),h.TgZ(2,"ion-label"),h._uU(3),h.ALo(4,"date"),h.qZA(),h.qZA()),2&t){const t=h.oxw(2);h.xp6(3),h.Oqu(h.xi3(4,1,t.checkedModel.checkedOut,"dd-MM-yyyy HH:mm"))}}function k(t,e){if(1&t&&(h.TgZ(0,"div",11),h.TgZ(1,"div",12),h.TgZ(2,"div",49),h.TgZ(3,"div",14),h._UZ(4,"div",15),h.qZA(),h.TgZ(5,"p",16),h._UZ(6,"img",17),h.qZA(),h.qZA(),h.YNc(7,O,5,1,"div",46),h.TgZ(8,"div",47),h.TgZ(9,"div",14),h._UZ(10,"div",15),h.qZA(),h.TgZ(11,"p",16),h._UZ(12,"img",20),h.qZA(),h.qZA(),h.qZA(),h.TgZ(13,"ion-card"),h.TgZ(14,"ion-card-content",21),h.TgZ(15,"ion-grid"),h.TgZ(16,"ion-row"),h._UZ(17,"ion-col",22),h.TgZ(18,"ion-col",23),h.TgZ(19,"ion-item",24),h._UZ(20,"ion-icon",25),h.TgZ(21,"ion-label",26),h.TgZ(22,"h2",27),h.TgZ(23,"b"),h._uU(24),h.qZA(),h.qZA(),h.TgZ(25,"p"),h._uU(26),h.qZA(),h.YNc(27,b,3,0,"ion-button",28),h.YNc(28,w,5,4,"ion-chip",29),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.YNc(29,U,16,5,"ion-card",30),h.TgZ(30,"ion-card"),h.TgZ(31,"ion-card-content",21),h.TgZ(32,"ion-grid"),h.TgZ(33,"ion-row"),h._UZ(34,"ion-col",22),h.TgZ(35,"ion-col",23),h.TgZ(36,"ion-item",24),h._UZ(37,"ion-icon",25),h.TgZ(38,"ion-label",26),h.TgZ(39,"h2",27),h.TgZ(40,"b"),h._uU(41),h.qZA(),h.qZA(),h.TgZ(42,"p"),h._uU(43),h.qZA(),h.YNc(44,P,3,0,"ion-button",28),h.YNc(45,D,5,4,"ion-chip",31),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&t){const t=h.oxw();h.xp6(7),h.Q6J("ngForOf",t.deliverdStops),h.xp6(17),h.Oqu(t.deliverdStops[0].XSTOFCY_0),h.xp6(2),h.Oqu(t.deliverdStops[0].XFCYDES_0),h.xp6(1),h.Q6J("ngIf",!t.isCheckedIn),h.xp6(1),h.Q6J("ngIf",t.isCheckedIn),h.xp6(1),h.Q6J("ngForOf",t.deliverdStops),h.xp6(12),h.Oqu(t.deliverdStops[0].XSTOFCY_0),h.xp6(2),h.Oqu(t.deliverdStops[0].XFCYDES_0),h.xp6(1),h.Q6J("ngIf",!t.isCheckedOut),h.xp6(1),h.Q6J("ngIf",t.isCheckedOut)}}function x(t,e){1&t&&(h.TgZ(0,"div",52),h.TgZ(1,"ion-row"),h.TgZ(2,"ion-col",53),h.TgZ(3,"b"),h._uU(4,"Oops no stops found!"),h.qZA(),h.qZA(),h.qZA(),h.qZA())}function X(t,e){1&t&&(h.TgZ(0,"div",52),h.TgZ(1,"ion-row"),h.TgZ(2,"ion-col",53),h.TgZ(3,"b"),h._uU(4,"Oops no stops found!"),h.qZA(),h.qZA(),h.qZA(),h.qZA())}function I(t,e){1&t&&(h.TgZ(0,"div",52),h.TgZ(1,"ion-row"),h.TgZ(2,"ion-col",53),h.TgZ(3,"b"),h._uU(4,"Oops no stops found!"),h.qZA(),h.qZA(),h.qZA(),h.qZA())}const y=[{path:"",component:(()=>{class t{constructor(t,e,i,o){this.router=t,this.utilService=e,this.routesService=i,this.route=o,this.isFuture=!1,this.isPrevious=!1,this.isCheckedIn=!1,this.isCheckedOut=!1,this.isStopActive=!1,this.isPreviousChecked=!1,this.isAllDeparture=!1,this.stopType="To-Do",this.checkedModel={checkedIn:"",checkedOut:""},this.route.queryParams.subscribe(t=>{t&&t.route?(this.routeId=t.route,this.stopType="To-Do",this.getStops()):localStorage.getItem("activeRouteId")&&(this.routeId=localStorage.getItem("activeRouteId"),this.stopType="To-Do",this.getStops())})}ngOnInit(){this.stopType="To-Do"}scroll(){var t;null===(t=this.content)||void 0===t||t.scrollToTop(0)}getStops(){return(0,r.mG)(this,void 0,void 0,function*(){yield this.utilService.showLoading(),this.routesService.getStops(this.routeId).subscribe(t=>{var e,i,o,s,n;if(this.completeWidgets(),this.stops=l.sortBy(t,"XCSGNUM_0"),(null===(e=this.stops[0])||void 0===e?void 0:e.XCKINTIM_0.length)>1){this.isCheckedIn=!0;let t=p(null===(i=this.stops[0])||void 0===i?void 0:i.XCKINDAT_0).format("YYYY-MM-DD"),e=new Date(t+" "+(null===(o=this.stops[0])||void 0===o?void 0:o.XCKINTIM_0));this.checkedModel.checkedIn=e}else this.isCheckedIn=!1;const c=l.filter(this.stops,t=>6==t.XSTATUS_0&&t.XCKOTTIM_0.length>1);if(this.stops.length==c.length){this.isCheckedOut=!0;let t=p(null===(s=this.stops[0])||void 0===s?void 0:s.XCKOTDAT_0).format("YYYY-MM-DD"),e=new Date(t+" "+(null===(n=this.stops[0])||void 0===n?void 0:n.XCKOTTIM_0));this.checkedModel.checkedOut=e}else this.isCheckedOut=!1;const r=l.filter(this.stops,{XISACTIVDOC_0:2});this.isStopActive=r.length>0;const h=l.filter(this.stops,{XDEPTIM_0:" "});this.isAllDeparture=!(h.length>0),this.searchedStops=l.cloneDeep(this.stops),this.filterStopsByStatus()},t=>{this.completeWidgets(),this.utilService.showErrorCall(t)})})}checkValidation(t){this.utilService.getStorageData("routes").then(e=>{const i=l.find(e,{XDRN_0:this.routeId});this.isFuture=i.XDLVDAT_0>new Date;const o=l.filter(this.stops,{XISACTIVDOC_0:2});if(this.isStopActive=o.length>0,1==i.XTRIP_0)this.isPrevious=!0;else{let t=l.find(e,{XTRIP_0:i.XTRIP_0-1,XDLVDAT_0:i.XDLVDAT_0});this.isPrevious=!(!t||5!=t.XROUTSTAT_0)}t()})}stopDetails(t,e){this.isCheckedIn?this.checkValidation(()=>{if(this.isFuture)this.utilService.showToast("Future routs not allowed.");else if(this.isPrevious){let i=l.find(this.stops,{XCSGNUM_0:e-1});if("2"===this.stops[0].Sequence){if(i&&(6!==(null==i?void 0:i.XSTATUS_0)||" "==(null==i?void 0:i.XDEPTIM_0)))return this.utilService.showToast("Complete above stops first."),!1;this.router.navigate(["/tabs/stop-list/stop-detail"],{queryParams:{stop:t}})}else"1"===this.stops[0].Sequence&&this.router.navigate(["/tabs/stop-list/stop-detail"],{queryParams:{stop:t}})}else this.utilService.showToast("Complete previous trip first.")}):this.utilService.showToast("Please check-in first.")}skipStop(t,e,i){t.preventDefault(),t.stopPropagation(),this.isCheckedIn?this.checkValidation(()=>{if(this.isFuture)this.utilService.showToast("Future routs not allowed.");else if(this.isStopActive)this.utilService.showToast("Complete active stop fisrt.");else if(this.isPrevious){let t=l.find(this.stops,{XCSGNUM_0:i-1});if("2"===this.stops[0].Sequence){if(t&&(6!==(null==t?void 0:t.XSTATUS_0)||" "==(null==t?void 0:t.XDEPTIM_0)))return this.utilService.showToast("Complete above stops first."),!1;this.currentStop=l.find(this.stops,{XDOCNUM_0:e}),1==this.currentStop.XSTATUS_0||5==this.currentStop.XSTATUS_0||6==this.currentStop.XSTATUS_0?this.utilService.showToast("Already skipped!"):this.router.navigate(["/tabs/stop-list/skip-stop"],{queryParams:{docNo:e}})}else"1"===this.stops[0].Sequence&&(this.currentStop=l.find(this.stops,{XDOCNUM_0:e}),1==this.currentStop.XSTATUS_0||5==this.currentStop.XSTATUS_0||6==this.currentStop.XSTATUS_0?this.utilService.showToast("Already skipped!"):this.router.navigate(["/tabs/stop-list/skip-stop"],{queryParams:{docNo:e}}))}else this.utilService.showToast("Complete previous trip first.")}):this.utilService.showToast("Please check-in first.")}cancelStop(t,e,i){t.preventDefault(),t.stopPropagation(),this.isCheckedIn?this.checkValidation(()=>{if(this.isFuture)this.utilService.showToast("Future routs not allowed.");else if(this.isPrevious){let t=l.find(this.stops,{XCSGNUM_0:i-1});if("2"===this.stops[0].Sequence){if(t&&(6!==(null==t?void 0:t.XSTATUS_0)||" "==(null==t?void 0:t.XDEPTIM_0)))return this.utilService.showToast("Complete above stops first."),!1;this.currentStop=l.find(this.stops,{XDOCNUM_0:e}),1==this.currentStop.XSTATUS_0||5==this.currentStop.XSTATUS_0||6==this.currentStop.XSTATUS_0?this.utilService.showToast("Already cancelled!"):this.router.navigate(["/tabs/stop-list/cancel-stop"],{queryParams:{docNo:e,displayType:"cancelStop"}})}else"1"===this.stops[0].Sequence&&(this.currentStop=l.find(this.stops,{XDOCNUM_0:e}),1==this.currentStop.XSTATUS_0||5==this.currentStop.XSTATUS_0||6==this.currentStop.XSTATUS_0?this.utilService.showToast("Already cancelled!"):this.router.navigate(["/tabs/stop-list/cancel-stop"],{queryParams:{docNo:e,displayType:"cancelStop"}}))}else this.utilService.showToast("Complete previous trip first.")}):this.utilService.showToast("Please check-in first.")}searchStops(){if(this.search){let t;"To-Do"==this.stopType?t=l.cloneDeep(this.searchedToDo):"Active"==this.stopType?t=l.cloneDeep(this.searchedActive):"Delivered"==this.stopType&&(t=l.cloneDeep(this.searchedDeliverd));const e=l.filter(t,t=>t.XDOCNUM_0.toLowerCase().indexOf(this.search.toLowerCase())>-1||t.XBPNAME_0.toLowerCase().indexOf(this.search.toLowerCase())>-1||t.XBPCORD_0.toLowerCase().indexOf(this.search.toLowerCase())>-1||t.XCTY_0.toLowerCase().indexOf(this.search.toLowerCase())>-1);this.todoStops=e,this.activeStops=e,this.deliverdStops=e}else"To-Do"==this.stopType?this.todoStops=l.cloneDeep(this.searchedToDo):"Active"==this.stopType?this.activeStops=l.cloneDeep(this.searchedActive):"Delivered"==this.stopType&&(this.deliverdStops=l.cloneDeep(this.searchedDeliverd))}filterStopsByStatus(){this.search="";const t=l.cloneDeep(this.stops);if("To-Do"==this.stopType)this.todoStops=l.filter(t,t=>1!==t.XSTATUS_0&&6!==t.XSTATUS_0&&2!=t.XISACTIVDOC_0),this.searchedToDo=l.cloneDeep(this.todoStops);else if("Active"==this.stopType)this.activeStops=l.filter(t,t=>(2==t.XISACTIVDOC_0||6==t.XSTATUS_0)&&" "==t.XDEPTIM_0),this.searchedActive=l.cloneDeep(this.activeStops);else if("Delivered"==this.stopType){this.deliverdStops=l.filter(t,t=>6==t.XSTATUS_0&&t.XDEPTIM_0.length>1);const e=this.deliverdStops.map((t,e)=>{let i=p(t.XFINDAT_0).format("YYYY-MM-DD"),o=new Date(i+" "+t.XFINTIME_0);const s=Object.assign({},t);return s.DLDATTIM=String(o),s});this.deliverdStops=e,this.searchedDeliverd=l.cloneDeep(this.deliverdStops)}this.scroll()}checkIn(){this.checkValidation(()=>{var t;if(this.isPrevious)if((null===(t=this.stops[0].XCKINTIM_0)||void 0===t?void 0:t.length)>1)this.utilService.showToast("Already checked-in.");else{const t={doc:this.routeId,datetime:p().format("YYYY-MM-DDTHH:mm:ss")};this.utilService.showConfirmationPopup("Check In","Are you sure you want to check in?",e=>{1==e&&this.routesService.postCheckIn(t).subscribe(t=>{this.isCheckedIn=!0,this.checkedModel.checkedIn=new Date,this.utilService.showToastSucccess("Checked-In Successfully at "+this.stops[0].XFCYDES_0+"("+this.stops[0].XSTOFCY_0+")")},t=>{this.isCheckedIn=!1,this.utilService.showErrorCall(t)})})}else this.utilService.showToast("Please complete the Route for Previous Trip.")})}checkOut(){var t;const e=l.filter(this.stops,{XSTATUS_0:6});if(this.stops.length==e.length&&this.isAllDeparture)if((null===(t=this.stops[0].XCKOTTIM_0)||void 0===t?void 0:t.length)>1)this.utilService.showToast("Already checked-out.");else{const t={doc:this.routeId,datetime:p().format("YYYY-MM-DDTHH:mm:ss")};this.utilService.showConfirmationPopup("Check Out","Are you sure you want to check out?",e=>{1==e&&this.routesService.postCheckOut(t).subscribe(t=>{this.isCheckedOut=!0,this.checkedModel.checkedOut=new Date,this.utilService.showToastSucccess("Stop checked-out successfully.")},t=>{this.utilService.showErrorCall(t)})})}else this.utilService.showToast("Please complete all the documents in the Route.")}ionViewDidLeave(){this.search=""}doRefresh(t){this.getStops()}completeWidgets(){this.utilService.dismissLoading(),this.pullToRefresh&&this.pullToRefresh.complete()}}return t.\u0275fac=function(e){return new(e||t)(h.Y36(c.F0),h.Y36(d.f),h.Y36(a._),h.Y36(c.gz))},t.\u0275cmp=h.Xpm({type:t,selectors:[["app-stop-list"]],viewQuery:function(t,e){if(1&t&&(h.Gf(n.W2,5),h.Gf(n.nJ,5)),2&t){let t;h.iGM(t=h.CRH())&&(e.content=t.first),h.iGM(t=h.CRH())&&(e.pullToRefresh=t.first)}},decls:27,vars:9,consts:[["color","dark"],["color","tertiary",1,"ion-no-padding"],["color","tertiary"],["slot","fixed",3,"ionRefresh"],["placeholder","Search","debounce","500",1,"pb-0",3,"ngModel","ngModelChange","ionChange"],["color","primary",3,"ngModel","ngModelChange","ionChange"],["value","To-Do"],["value","Active"],["value","Delivered"],["class","stop-list",4,"ngIf"],["class","ion-text-center no-stops",4,"ngIf"],[1,"stop-list"],[1,"bs-wizard"],[1,"bs-wizard-step","todo-steps","check-in"],[1,"progress"],[1,"progress-bar"],[1,"bs-wizard-dot"],["src","assets/images/check-in.png"],["class","bs-wizard-step",3,"ngClass",4,"ngFor","ngForOf"],[1,"bs-wizard-step","todo-steps"],["src","assets/images/check-out.png"],[1,"p-5"],["size","3",1,"stop-progress-bar"],["size","9",1,"pt-0"],["lines","none",1,"ion-no-padding"],["slot","end","name","home","color","secondary"],[1,"mt-0","mb-0"],[1,"fs-18"],["fill","outline","color","success","class","ion-margin-top mb-0",3,"click",4,"ngIf"],["class","ml-0 mb-0","color","success",4,"ngIf"],[3,"click",4,"ngFor","ngForOf"],["class","ml-0","color","success",4,"ngIf"],[1,"bs-wizard-step",3,"ngClass"],["fill","outline","color","success",1,"ion-margin-top","mb-0",3,"click"],["color","success",1,"ml-0","mb-0"],["name","checkmark-circle"],[3,"click"],[1,"p-5","todo-list-data"],[1,"pb-0"],["size","9",1,"pb-0"],[1,"mb-0"],[1,"my-8","text-dark"],["color","warning",4,"ngIf"],["color","warning"],["name","arrow-redo-outline"],["color","success",1,"ml-0"],["class","bs-wizard-step",4,"ngFor","ngForOf"],[1,"bs-wizard-step"],[1,"p-5","list-data"],[1,"bs-wizard-step","check-in"],["color","success",4,"ngIf"],["color","success"],[1,"ion-text-center","no-stops"],["size","12"]],template:function(t,e){1&t&&(h.TgZ(0,"ion-header"),h.TgZ(1,"ion-toolbar",0),h.TgZ(2,"ion-title",1),h._uU(3),h.qZA(),h.qZA(),h.qZA(),h.TgZ(4,"ion-content",2),h.TgZ(5,"ion-refresher",3),h.NdJ("ionRefresh",function(t){return e.doRefresh(t)}),h._UZ(6,"ion-refresher-content"),h.qZA(),h.TgZ(7,"ion-searchbar",4),h.NdJ("ngModelChange",function(t){return e.search=t})("ionChange",function(){return e.searchStops()}),h.qZA(),h.TgZ(8,"ion-segment",5),h.NdJ("ngModelChange",function(t){return e.stopType=t})("ionChange",function(){return e.filterStopsByStatus()}),h.TgZ(9,"ion-segment-button",6),h.TgZ(10,"ion-label"),h.TgZ(11,"b"),h._uU(12,"To-Do"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(13,"ion-segment-button",7),h.TgZ(14,"ion-label"),h.TgZ(15,"b"),h._uU(16,"Active"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(17,"ion-segment-button",8),h.TgZ(18,"ion-label"),h.TgZ(19,"b"),h._uU(20,"Delivered"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.YNc(21,f,46,10,"div",9),h.YNc(22,M,4,2,"div",9),h.YNc(23,k,46,10,"div",9),h.YNc(24,x,5,0,"div",10),h.YNc(25,X,5,0,"div",10),h.YNc(26,I,5,0,"div",10),h.qZA()),2&t&&(h.xp6(3),h.Oqu(e.routeId),h.xp6(4),h.Q6J("ngModel",e.search),h.xp6(1),h.Q6J("ngModel",e.stopType),h.xp6(13),h.Q6J("ngIf",(null==e.todoStops?null:e.todoStops.length)>0&&"To-Do"==e.stopType),h.xp6(1),h.Q6J("ngIf",(null==e.activeStops?null:e.activeStops.length)>0&&"Active"==e.stopType),h.xp6(1),h.Q6J("ngIf",(null==e.deliverdStops?null:e.deliverdStops.length)>0&&"Delivered"==e.stopType),h.xp6(1),h.Q6J("ngIf",0==(null==e.todoStops?null:e.todoStops.length)&&"To-Do"==e.stopType),h.xp6(1),h.Q6J("ngIf",0==(null==e.activeStops?null:e.activeStops.length)&&"Active"==e.stopType),h.xp6(1),h.Q6J("ngIf",0==(null==e.deliverdStops?null:e.deliverdStops.length)&&"Delivered"==e.stopType))},directives:[n.Gu,n.sr,n.wd,n.W2,n.nJ,n.Wo,n.VI,n.j9,s.JJ,s.On,n.cJ,n.QI,n.GO,n.Q$,o.O5,o.sg,n.PM,n.FN,n.jY,n.Nd,n.wI,n.Ie,n.gu,o.mk,n.YG,n.hM,n.tO],pipes:[o.uU],styles:[".stop-list[_ngcontent-%COMP%]{width:100%;position:relative}.stop-list[_ngcontent-%COMP%]   .list-data[_ngcontent-%COMP%]{min-height:145px}.stop-list[_ngcontent-%COMP%]   .todo-list-data[_ngcontent-%COMP%]{min-height:101px}.stop-list[_ngcontent-%COMP%]   .stop-progress-bar[_ngcontent-%COMP%]{width:140px!important}.stop-list[_ngcontent-%COMP%]   .chipmt[_ngcontent-%COMP%]{margin-top:22px}.stop-list[_ngcontent-%COMP%]   .bs-wizard[_ngcontent-%COMP%]{position:absolute;top:16px;left:35px;z-index:1}.stop-list[_ngcontent-%COMP%]   .bs-wizard[_ngcontent-%COMP%]   .bs-wizard-step[_ngcontent-%COMP%]{padding:0;position:relative;min-height:169px}.stop-list[_ngcontent-%COMP%]   .bs-wizard[_ngcontent-%COMP%]   .bs-wizard-step[_ngcontent-%COMP%]   .bs-wizard-dot[_ngcontent-%COMP%]{width:64px;position:absolute;top:0;left:0;background:var(--ion-color-primary-tint);border-radius:15px;color:var(--ion-color-light);padding:3px 0;font-size:14px;font-weight:600;text-align:center}.stop-list[_ngcontent-%COMP%]   .bs-wizard[_ngcontent-%COMP%]   .bs-wizard-step[_ngcontent-%COMP%]   .bs-wizard-dot[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:30%!important}.stop-list[_ngcontent-%COMP%]   .bs-wizard[_ngcontent-%COMP%]   .bs-wizard-step[_ngcontent-%COMP%]   .progress[_ngcontent-%COMP%]{position:absolute;border-radius:0;height:100%;box-shadow:none;width:6px;left:29px;top:15px;margin-top:0!important;animation:moveline 1s;animation-fill-mode:forwards}.stop-list[_ngcontent-%COMP%]   .bs-wizard[_ngcontent-%COMP%]   .check-in[_ngcontent-%COMP%]{padding:0;position:relative;min-height:130px}.stop-list[_ngcontent-%COMP%]   .bs-wizard[_ngcontent-%COMP%]   .bs-wizard-step.todo-steps[_ngcontent-%COMP%]{min-height:127px!important}.stop-list[_ngcontent-%COMP%]   .bs-wizard[_ngcontent-%COMP%]   .bs-wizard-step.isSkip[_ngcontent-%COMP%]{min-height:168px!important}.bs-wizard[_ngcontent-%COMP%] > .bs-wizard-step[_ngcontent-%COMP%] > .progress[_ngcontent-%COMP%] > .progress-bar[_ngcontent-%COMP%]{width:0;box-shadow:none;background:var(--ion-color-primary-tint)}.bs-wizard[_ngcontent-%COMP%] > .bs-wizard-step.complete[_ngcontent-%COMP%] > .progress[_ngcontent-%COMP%] > .progress-bar[_ngcontent-%COMP%]{width:100%}.bs-wizard[_ngcontent-%COMP%] > .bs-wizard-step.active[_ngcontent-%COMP%] > .progress[_ngcontent-%COMP%] > .progress-bar[_ngcontent-%COMP%]{width:100%;height:0}.bs-wizard[_ngcontent-%COMP%] > .bs-wizard-step[_ngcontent-%COMP%]:first-child.active > .progress[_ngcontent-%COMP%] > .progress-bar[_ngcontent-%COMP%]{width:0}.bs-wizard[_ngcontent-%COMP%] > .bs-wizard-step[_ngcontent-%COMP%]:last-child.active > .progress[_ngcontent-%COMP%] > .progress-bar[_ngcontent-%COMP%]{width:100%}.bs-wizard[_ngcontent-%COMP%] > .bs-wizard-step[_ngcontent-%COMP%]:last-child > .progress[_ngcontent-%COMP%]{display:none!important}@keyframes moveline{0%{height:0}to{height:100%}}.no-stops[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;top:0;left:0;height:100%;width:100%}"]}),t})()},{path:"stop-detail",loadChildren:()=>Promise.all([i.e(8592),i.e(4163)]).then(i.bind(i,4163)).then(t=>t.StopDetailPageModule)},{path:"skip-stop",loadChildren:()=>i.e(6393).then(i.bind(i,6393)).then(t=>t.SkipStopPageModule)},{path:"cancel-stop",loadChildren:()=>Promise.all([i.e(291),i.e(4685)]).then(i.bind(i,4685)).then(t=>t.CancelStopPageModule)}];let N=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=h.oAB({type:t}),t.\u0275inj=h.cJS({imports:[[c.Bz.forChild(y)],c.Bz]}),t})(),Y=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=h.oAB({type:t}),t.\u0275inj=h.cJS({imports:[[o.ez,s.u5,n.Pc,N]]}),t})()}}]);