(self.webpackChunkcap=self.webpackChunkcap||[]).push([[641],{641:(e,t,o)=>{"use strict";o.r(t),o.d(t,{OrsPageModule:()=>f});var i=o(1116),n=o(1041),s=o(5394),r=o(3146),a=o(4762),l=o(3523),c=o(9609),p=o(5614),g=o(2693),m=o(5724),u=o(8579);const h=[{path:"",component:(()=>{class e{constructor(e,t,o){this.http=e,this.utilService=t,this.routeService=o}ngOnInit(){this.initMap()}initMap(){this.directionsService=new google.maps.DirectionsService({optimizeWaypoints:!0}),this.directionsDisplay=new google.maps.DirectionsRenderer({polylineOptions:{strokeColor:"#009e71",strokeWeight:7}}),this.googleMap||(this.googleMap=new google.maps.Map(document.getElementById("map_canvas"),{mapTypeControl:!1,streetViewControl:!1,zoom:10,center:{lat:21.1702,lng:72.8311},styles:l.M}))}getRoute(){return(0,a.mG)(this,void 0,void 0,function*(){yield this.utilService.showLoading(),this.routeService.oprimizeRoute().subscribe(e=>{this.utilService.dismissLoading(),e&&0==e.code?(this.orsResult=e,this.setMarker()):this.utilService.showErrorCall(e)},e=>{this.utilService.dismissLoading(),this.utilService.showErrorCall(e)})})}setMarker(){const e={url:"assets/images/pin.png",labelOrigin:new google.maps.Point(16,12)},t=this.orsResult.routes[0].steps,o=new google.maps.Marker({position:{lat:Number(t[0].location[1]),lng:Number(t[0].location[0])},map:this.googleMap,icon:"assets/images/home.png",label:{text:" ",fontSize:"15px",fontWeight:"bold",color:"#ffffff"}}),i=new google.maps.InfoWindow;if(i.setContent("<b>Start : "+c(new Date(1e3*t[0].arrival)).format("DD/MM/YYYY hh:mm A")+"</b><br><b>End : "+c(new Date(1e3*t[t.length-1].arrival)).format("DD/MM/YYYY hh:mm A")+"</b>"),i.open(o.getMap(),o),t.map((o,i)=>{if(this.googleMap&&i!=t.length-1&&0!=i){const t=new google.maps.Marker({position:{lat:Number(o.location[1]),lng:Number(o.location[0])},map:this.googleMap,icon:e,label:{text:i+"",fontSize:"15px",fontWeight:"bold",color:"#ffffff"},title:o.XBPNAME_0}),n=new google.maps.InfoWindow;n.setContent("<b>Doc Id: "+o.id+"</b><br><b>Customer: John Doe</b><br><b>Type: "+o.type+"</b><br><b>Arrival : "+c(new Date(1e3*o.arrival)).format("DD/MM/YYYY hh:mm A")+"</b><br><b>Service Time: "+(o.service/60|0)+" min</b><br><b>Departure : "+c(new Date(1e3*(o.arrival+o.service))).format("DD/MM/YYYY hh:mm A")+"</b><br>"),n.open(t.getMap(),t)}return o}),t&&t.length>0){const e=t[0],o=t[t.length-1],i=[];for(let s=1;s<t.length-1;s++)i.push({location:{lat:t[s].location[1],lng:t[s].location[0]}});let n={origin:{lat:Number(e.location[1]),lng:Number(e.location[0])},waypoints:i,destination:{lat:Number(o.location[1]),lng:Number(o.location[0])},travelMode:google.maps.DirectionsTravelMode.DRIVING};this.directionsService.route(n,(e,t)=>{t==google.maps.DirectionsStatus.OK&&(this.directionsDisplay.setDirections(e),this.directionsDisplay.setMap(this.googleMap),this.directionsDisplay.setOptions({suppressMarkers:!0}))})}}}return e.\u0275fac=function(t){return new(t||e)(p.Y36(g.eN),p.Y36(m.f),p.Y36(u._))},e.\u0275cmp=p.Xpm({type:e,selectors:[["app-ors"]],decls:6,vars:0,consts:[["id","map_canvas",1,"google-map","h-100"],["expand","full",3,"click"]],template:function(e,t){1&e&&(p.TgZ(0,"ion-content"),p._UZ(1,"div",0),p.qZA(),p.TgZ(2,"ion-footer"),p.TgZ(3,"ion-toolbar"),p.TgZ(4,"ion-button",1),p.NdJ("click",function(){return t.getRoute()}),p._uU(5," Get Route "),p.qZA(),p.qZA(),p.qZA())},directives:[s.W2,s.fr,s.sr,s.YG],styles:[""]}),e})()}];let b=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=p.oAB({type:e}),e.\u0275inj=p.cJS({imports:[[r.Bz.forChild(h)],r.Bz]}),e})(),f=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=p.oAB({type:e}),e.\u0275inj=p.cJS({imports:[[i.ez,n.u5,s.Pc,b]]}),e})()}}]);