import{a as pe}from"./chunk-SONPGGEU.js";import{a as de}from"./chunk-RQDT4XZ7.js";import{a as T}from"./chunk-2JS6YH6L.js";import{a as ae}from"./chunk-QM6S56NU.js";import{F as K,G as J,H as Q,I as q,J as X,K as Z,M as ee,O as te,Q as ne,R as ie,S as oe,T as re,W as le,h as R,j as H}from"./chunk-FE5VBTEA.js";import{$b as Y,Ea as E,Lb as j,Ob as B,Pa as C,Qa as x,Ra as P,S as F,Ta as v,Tb as G,Ua as O,Va as _,Wa as r,X as m,Xa as l,Xb as z,Y as g,Ya as h,Zb as U,cb as w,db as b,eb as c,gc as W,ib as L,jb as k,kb as V,lb as D,mb as u,nb as y,ob as I,pb as N,ra as a,tb as A,vb as $,wb as S}from"./chunk-GRN3H2SR.js";import"./chunk-G6YDIQMH.js";import"./chunk-QUJFQN2Y.js";import"./chunk-MYQFGRTU.js";import"./chunk-ICD62ZI6.js";import"./chunk-KJTYSHOU.js";import"./chunk-WDCFTLNW.js";import"./chunk-6DGKYHY4.js";import"./chunk-QRGYPJ3R.js";import"./chunk-XT3ASKXO.js";import"./chunk-QNCTVU3D.js";import"./chunk-2U5ZQUOG.js";import"./chunk-Y752I26P.js";import"./chunk-AYE7MORG.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-C4NKN25D.js";import"./chunk-CKP3SGE2.js";import"./chunk-EDJS6UIH.js";import"./chunk-IMHACM5W.js";import"./chunk-SBA6VKRK.js";import"./chunk-G47TABXB.js";import"./chunk-BUMCRR6Y.js";import"./chunk-DNTR6X5U.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-3QXY74KK.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{g as ue}from"./chunk-B7O3QC5Z.js";var se=ue(pe());var M=o=>[o],_e=()=>[2,3,4,5,6,7,8];function be(o,d){if(o&1&&(r(0,"div",9)(1,"ion-label"),u(2),l()()),o&2){let i=c();a(2),y(i.selectedProduct[0].productName)}}function me(o,d){if(o&1&&(r(0,"th"),u(1),l()),o&2){let i=d.$implicit;a(),y(i.day)}}function ge(o,d){if(o&1&&(r(0,"th"),u(1),l()),o&2){let i=d.$implicit;a(),y(i.date)}}function he(o,d){o&1&&h(0,"td")(1,"td")}function fe(o,d){o&1&&(r(0,"ion-text",34),u(1,"%"),l())}function Ce(o,d){if(o&1){let i=w();r(0,"td",31)(1,"input",32),b("ngModelChange",function(e){m(i);let n=c().$index,s=c().$implicit,p=c(2);return g(p.onValueEdit(s.productId,n,0,e))}),l()(),r(2,"td",33)(3,"input",32),b("ngModelChange",function(e){m(i);let n=c().$index,s=c().$implicit,p=c(2);return g(p.onValueEdit(s.productId,n,1,e))}),l(),C(4,fe,2,0,"ion-text",34),l()}if(o&2){let i=c(),t=i.$implicit,e=i.$index;_("ngClass",S(5,M,"label-cell-"+e)),a(),_("ngModel",t.values[0]),a(),_("ngClass",S(7,M,"label-cell-"+e)),a(),_("ngModel",t.values[1]),a(),x(e==1?4:-1)}}function xe(o,d){if(o&1){let i=w();r(0,"td",29)(1,"input",32),b("ngModelChange",function(e){let n=m(i).$implicit,s=c().$index,p=c().$implicit,f=c(2);return g(f.onValueEdit(p.productId,s,n,e))}),l()()}if(o&2){let i=d.$implicit,t=c(),e=t.$implicit,n=t.$index;D(A("label-cell-sub-",i-1)),_("ngClass",S(5,M,"label-cell-"+n)),a(),_("ngModel",e.values[i])}}function Pe(o,d){if(o&1&&(r(0,"tr")(1,"td",29),u(2),l(),C(3,he,2,0)(4,Ce,5,9),r(5,"td",29),u(6),l(),v(7,xe,2,7,"td",30,P),r(9,"td"),u(10),l()()),o&2){let i=d.$implicit,t=d.$index,e=c(3);a(),_("ngClass",S(6,M,"label-cell-"+t)),a(),I(" ",i.label||""," "),a(),x(e.isNotShowMainSubLabel.includes(i.subLabel)?3:4),a(2),_("ngClass",S(8,M,"label-cell-"+t)),a(),I(" ",i.subLabel||""," "),a(),O($(10,_e)),a(3),y(e.getRowTotal(i))}}function ve(o,d){if(o&1&&(r(0,"tr")(1,"td",27),u(2),l(),h(3,"td"),l(),v(4,Pe,11,11,"tr",null,P),r(6,"tr"),h(7,"td",28),l()),o&2){let i=d.$implicit;a(2),N(" ",i.productCode," - ",i.productName," "),a(2),O(i.rows)}}function Oe(o,d){o&1&&(r(0,"tr")(1,"td",35),u(2,"No data found"),l()())}function Se(o,d){if(o&1){let i=w();r(0,"ion-button",25),b("click",function(){m(i);let e=c(2);return g(e.saveProductData())}),r(1,"ion-text",18),u(2,"Save"),l()()}}function we(o,d){if(o&1){let i=w();r(0,"div",10)(1,"ion-card",11)(2,"ion-row",12)(3,"ion-col",13)(4,"ion-button",14),b("click",function(){m(i);let e=c();return g(e.goFirst())}),h(5,"ion-icon",15),l()(),r(6,"ion-col",16)(7,"ion-button",17),b("click",function(){m(i);let e=c();return g(e.previousProduct())}),r(8,"ion-text",18),u(9,"Previous"),l()()(),r(10,"ion-col",16)(11,"ion-button",17),b("click",function(){m(i);let e=c();return g(e.nextProduct())}),r(12,"ion-text",18),u(13,"Next"),l()()(),r(14,"ion-col",13)(15,"ion-button",14),b("click",function(){m(i);let e=c();return g(e.goLast())}),h(16,"ion-icon",19),l()()(),r(17,"div",20)(18,"div",21)(19,"table",22)(20,"thead")(21,"tr"),h(22,"th")(23,"th")(24,"th")(25,"th"),v(26,me,2,1,"th",null,P),h(28,"th"),l()(),r(29,"tbody")(30,"tr"),h(31,"th")(32,"th")(33,"th")(34,"th"),v(35,ge,2,1,"th",null,P),r(37,"th"),u(38,"Total"),l()(),v(39,ve,8,2,null,null,P,!1,Oe,3,0,"tr"),l()()()(),r(42,"ion-row",23)(43,"ion-col",24)(44,"ion-button",25),b("click",function(){m(i);let e=c();return g(e.exitProgram())}),r(45,"ion-text",18),u(46,"Exit Program"),l()()(),r(47,"ion-col",24),C(48,Se,3,0,"ion-button",26),l()()()()}if(o&2){let i=c();a(4),_("disabled",i.isPrevDisabled()),a(3),_("disabled",i.isPrevDisabled()),a(4),_("disabled",i.isNextDisabled()),a(4),_("disabled",i.isNextDisabled()),a(11),O(i.tableDates),a(9),O(i.tableDates),a(4),O(i.selectedProduct),a(9),x(i.isDirty?48:-1)}}function ye(o,d){o&1&&(r(0,"div",10)(1,"ion-card",36)(2,"ion-card-content")(3,"ion-row")(4,"ion-col")(5,"ion-text",37),u(6,"No any product selected yet. Please select any one product."),l()()()()()())}var Be=(()=>{let d=class d{constructor(){this.utilService=F(ae),this.router=F(H),this.routeActive=F(R),this.isNotShowMainSubLabel=["Tablet Adj","Final Order"],this.selectedProduct=[],this.selectedProductId=null,this.currentIndex=0,this.tempChanges={},this.STORAGE_KEY="final_order_adjustment",this.initialLoad=!1,this.isDirty=!1,this.selectedCustomerId=null,this.filteredProducts=[],this.tableDates=[],this.customerProductList=[{customerId:1,products:[5820,5921,6032]},{customerId:2,products:[5921,6032,6145]},{customerId:3,products:[5820,5921,6032]},{customerId:4,products:[6032,6145,5921]},{customerId:5,products:[5820,6032,6145]}],this.products=[{productId:5820,productCode:"*5820*",productName:"BUNNY WHOLE WHEAT 20",rows:[{label:"On Hand",subLabel:"Previous Ord Adj",values:[0,0,0,0,0,0,0,0,0,0]},{label:"Gamble",subLabel:"Shipping Adj",values:[0,0,0,0,0,0,0,0,0,0]},{label:null,subLabel:"Tablet Adj",values:[0,0,0,0,0,0,0,0,0,0]},{label:"Facing",subLabel:"Average Sold",values:[0,0,0,0,0,0,0,0,0,0]},{label:"Ord Unit",subLabel:"Previous Wk Sold",values:[0,0,0,0,0,0,0,0,0,0]},{label:"Tray Cnt",subLabel:"Current Order",values:[0,0,0,0,0,0,0,0,0,0]},{label:"OH Tue",subLabel:"Suggest Order",values:[0,0,0,0,0,0,0,0,0,0]},{label:"",subLabel:"Final Order",values:[0,0,0,0,0,0,0,0,0,0]}]},{productId:5921,productCode:"*5921*",productName:"BUNNY KING WHITE 22",rows:[{label:"On Hand",subLabel:"Previous Ord Adj",values:[0,0,0,0,0,0,0,0,0,0]},{label:"Gamble",subLabel:"Shipping Adj",values:[0,0,0,0,0,0,0,0,0,0]},{label:null,subLabel:"Tablet Adj",values:[0,0,0,0,0,0,0,0,0,0]},{label:"Facing",subLabel:"Average Sold",values:[0,0,0,0,0,0,0,0,0,0]},{label:"Ord Unit",subLabel:"Previous Wk Sold",values:[0,0,0,0,0,0,0,0,0,0]},{label:"Tray Cnt",subLabel:"Current Order",values:[0,0,0,0,0,0,0,0,0,0]},{label:"OH Tue",subLabel:"Suggest Order",values:[0,0,0,0,0,0,0,0,0,0]},{label:"",subLabel:"Final Order",values:[0,0,0,0,0,0,0,0,0,0]}]},{productId:6032,productCode:"*6032*",productName:"BUNNY BUNS 12 CT",rows:[{label:"On Hand",subLabel:"Previous Ord Adj",values:[0,0,0,0,0,0,0,0,0,0]},{label:"Gamble",subLabel:"Shipping Adj",values:[0,0,0,0,0,0,0,0,0,0]},{label:null,subLabel:"Tablet Adj",values:[0,0,0,0,0,0,0,0,0,0]},{label:"Facing",subLabel:"Average Sold",values:[0,0,0,0,0,0,0,0,0,0]},{label:"Ord Unit",subLabel:"Previous Wk Sold",values:[0,0,0,0,0,0,0,0,0,0]},{label:"Tray Cnt",subLabel:"Current Order",values:[0,0,0,0,0,0,0,0,0,0]},{label:"OH Tue",subLabel:"Suggest Order",values:[0,0,0,0,0,0,0,0,0,0]},{label:"",subLabel:"Final Order",values:[0,0,0,0,0,0,0,0,0,0]}]},{productId:6145,productCode:"*6145*",productName:"BUNNY GARLIC BREAD",rows:[{label:"On Hand",subLabel:"Previous Ord Adj",values:[0,0,0,0,0,0,0,0,0,0]},{label:"Gamble",subLabel:"Shipping Adj",values:[0,0,0,0,0,0,0,0,0,0]},{label:null,subLabel:"Tablet Adj",values:[0,0,0,0,0,0,0,0,0,0]},{label:"Facing",subLabel:"Average Sold",values:[0,0,0,0,0,0,0,0,0,0]},{label:"Ord Unit",subLabel:"Previous Wk Sold",values:[0,0,0,0,0,0,0,0,0,0]},{label:"Tray Cnt",subLabel:"Current Order",values:[0,0,0,0,0,0,0,0,0,0]},{label:"OH Tue",subLabel:"Suggest Order",values:[0,0,0,0,0,0,0,0,0,0]},{label:"",subLabel:"Final Order",values:[0,0,0,0,0,0,0,0,0,0]}]}],this.selectedProductId=null}ngOnInit(){let t=Number(this.routeActive.snapshot.queryParams.customerId);this.selectedCustomerId=t,this.filterProductsByCustomer(t),this.generateTableDates()}generateTableDates(){let t=(0,se.default)();this.tableDates=[];for(let e=0;e<7;e++){let n=t.clone().add(e,"days");this.tableDates.push({date:n.format("DD/MM"),day:n.format("ddd")})}}filterProductsByCustomer(t){let e=this.customerProductList.find(s=>s.customerId===t);this.filteredProducts=e?this.products.filter(s=>e.products.includes(s.productId)):[];let n=this.filteredProducts.slice(0,2);n.forEach(s=>{this.applySavedValuesForProduct(s)}),this.selectedProduct=n,this.currentIndex=0,this.initialLoad=this.filteredProducts.length>2}applySavedValuesForProduct(t){let e=this.loadSingleProductData(t.productId);t.rows.forEach((n,s)=>{n.values=n.values.map((p,f)=>e?.[s]?.[f]??p)})}goFirst(){this.products.length>0&&this.setSelectedProduct(0)}onProductSelected(t){this.selectedProduct=[t],this.selectedProductId=t.productId;let e=this.filteredProducts.findIndex(n=>n.productId===t.productId);e!==-1&&this.setSelectedProduct(e)}setSelectedProduct(t){this.currentIndex=t,(!this.selectedProduct||this.selectedProduct[0].productId!==this.filteredProducts[t].productId)&&(this.selectedProduct=[this.filteredProducts[t]]),this.selectedProductId=this.selectedProduct[0].productId;let e=this.loadSingleProductData(this.selectedProductId);this.applyStoredValues(e)}ionViewWillEnter(){this.selectedProductId=null,this.initialLoad=!1,setTimeout(()=>this.productSearch?.reset(),50)}loadSingleProductData(t){let e=JSON.parse(localStorage.getItem(this.STORAGE_KEY)||"{}");return e[t]||(e[t]={},this.saveAll(e)),e[t]}applyStoredValues(t){this.selectedProduct[0].rows.forEach((e,n)=>{e.values.forEach((s,p)=>{let f=t?.[n]&&t[n][p]!==void 0?t[n][p]:s;e.values[p]=f})})}onValueEdit(t,e,n,s){let p=Number(s),f=this.selectedProduct.find(ce=>ce.productId===t);f&&(f.rows[e].values[n]=p),this.tempChanges[t]||(this.tempChanges[t]={}),this.tempChanges[t][e]||(this.tempChanges[t][e]={}),this.tempChanges[t][e][n]=p,this.isDirty=!0}getRowTotal(t){return t.values.slice(2,9).reduce((e,n)=>e+Number(n||0),0)}saveProductData(){let t=JSON.parse(localStorage.getItem(this.STORAGE_KEY)||"{}");Object.keys(this.tempChanges).forEach(e=>{t[e]||(t[e]={}),Object.keys(this.tempChanges[e]).forEach(n=>{t[e][n]||(t[e][n]={}),Object.assign(t[e][n],this.tempChanges[e][n])})}),localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t)),this.tempChanges={},this.isDirty=!1}saveAll(t){localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t))}previousProduct(){if(this.currentIndex<=0)return;this.currentIndex=this.currentIndex===2?1:this.currentIndex-1;let t=this.filteredProducts[this.currentIndex];this.selectedProduct=[t],this.selectedProductId=t.productId;let e=this.loadSingleProductData(t.productId);this.applyStoredValues(e),this.isDirty=!1}nextProduct(){this.initialLoad?(this.currentIndex+=2,this.initialLoad=!1,this.isDirty=!1):(this.currentIndex++,this.isDirty=!1);let t=this.filteredProducts[this.currentIndex];this.selectedProduct=[t],this.selectedProductId=t.productId;let e=this.loadSingleProductData(t.productId);this.applyStoredValues(e)}goLast(){let t=this.filteredProducts.length-1,e=this.filteredProducts[t];this.selectedProduct=[e],this.selectedProductId=e.productId;let n=this.loadSingleProductData(e.productId);this.applyStoredValues(n),this.currentIndex=t}isPrevDisabled(){return this.currentIndex<=0}isNextDisabled(){return this.filteredProducts.length<=2?!0:this.currentIndex>=this.filteredProducts.length-1}goTo(){this.router.navigate(["/client-list/final"])}exitProgram(){this.utilService.showConfirmationPopup("Exit Program","Are you sure you want to exit?",t=>{t===1&&this.router.navigate(["/home"])})}};d.\u0275fac=function(e){return new(e||d)},d.\u0275cmp=E({type:d,selectors:[["app-final-order"]],viewQuery:function(e,n){if(e&1&&L(T,5),e&2){let s;k(s=V())&&(n.productSearch=s.first)}},decls:17,vars:4,consts:[["color","primary"],["slot","start",3,"click"],["name","chevron-back-outline",1,"fs-22"],[1,"fs-18","ml-5"],[1,"fs-18","ion-text-center"],[1,"ion-padding"],["size","12","size-sm","6",1,"p-0"],[1,"fs-17","fw-600"],["labelKey","productId","placeholder","Search Product",3,"selected","list","selectedValue"],[1,"mt-3"],[1,"mt-4"],[1,"p-2","text-black","m-0"],[1,"ion-align-items-center","ion-justify-content-end","flex-column","flex-sm-row"],["size","2","sizeLg","1"],["fill","solid",1,"dos-btn",3,"click","disabled"],["slot","icon-only","name","play-back-outline"],["size","4","sizeLg","2"],["expand","block",1,"dos-btn",3,"click","disabled"],[1,"btn-text"],["slot","icon-only","name","play-forward-outline"],[1,"product-block"],[1,"table-wrapper"],[1,"order-table","table-responsive"],[1,"ion-margin-top"],["size","6","sizeLg","2"],["fill","solid",1,"dos-btn",3,"click"],["fill","solid",1,"dos-btn"],["colspan","11",1,"text-end","fw-semibold","px-4"],["colspan","12",2,"padding","10px"],[3,"ngClass"],[3,"ngClass","class"],[1,"label-main-sub-1",3,"ngClass"],["type","number",1,"table-input",3,"ngModelChange","ngModel"],[1,"label-main-sub-2","position-relative",3,"ngClass"],[1,"percent-badge","ms-2"],["colspan","12",1,"text-center"],[1,"m-0"],[1,"fs-16","fw-600","text-black","justify-content-center","d-flex"]],template:function(e,n){e&1&&(r(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),b("click",function(){return n.goTo()}),h(3,"ion-icon",2),r(4,"span",3),u(5,"Back"),l()(),r(6,"ion-title",4),u(7," Final Order "),l()()(),r(8,"ion-content",5)(9,"ion-row")(10,"ion-col",6)(11,"ion-label",7),u(12,"Product :"),l(),r(13,"app-search-dropdown",8),b("selected",function(p){return n.onProductSelected(p)}),l(),C(14,be,3,1,"div",9),l()(),C(15,we,49,6,"div",10)(16,ye,7,0,"div",10),l()),e&2&&(a(13),_("list",n.filteredProducts)("selectedValue",n.selectedProduct[0]),a(),x(n.selectedProductId?14:-1),a(),x(n.selectedProduct?15:16))},dependencies:[ee,re,oe,Z,J,K,le,de,W,G,Y,z,U,B,j,ie,X,ne,Q,te,q,T],styles:[".product-block[_ngcontent-%COMP%]{margin-bottom:24px;border-radius:8px;border:1px solid #e5e5e5;overflow:hidden;background:#fafafa}.product-title[_ngcontent-%COMP%]{font-weight:700;padding:12px;background:#f1f1f1;border-bottom:1px solid #ddd}.dos-btn[_ngcontent-%COMP%]{--border-radius: 8px;--border-style: solid;text-transform:none;font-size:16px;font-weight:500;height:auto;display:block}input[_ngcontent-%COMP%]{width:50px;border-radius:5px;text-align:center;border:1px solid black}input[_ngcontent-%COMP%]:focus, ion-input[_ngcontent-%COMP%]:focus, .table-input[_ngcontent-%COMP%]:focus{box-shadow:none!important;-webkit-box-shadow:none!important;outline:none!important}.table-wrapper[_ngcontent-%COMP%]{width:100%;overflow-x:auto;overflow-y:hidden;-webkit-overflow-scrolling:touch}.table-wrapper[_ngcontent-%COMP%]   .percent-badge[_ngcontent-%COMP%]{position:absolute;top:50%;transform:translateY(-50%);font-size:14px;font-weight:600}.table-wrapper[_ngcontent-%COMP%]   .order-table[_ngcontent-%COMP%]{width:100%;min-width:960px;border-collapse:collapse;overflow-x:auto}.table-wrapper[_ngcontent-%COMP%]   .order-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(1){background:#f7f7f7}.table-wrapper[_ngcontent-%COMP%]   .order-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:8px;border-bottom:1px solid #ddd;text-align:center}.table-wrapper[_ngcontent-%COMP%]   .order-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(1){width:8%;font-weight:600}.table-wrapper[_ngcontent-%COMP%]   .order-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(4){width:10%;font-weight:600}.table-wrapper[_ngcontent-%COMP%]   .order-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px;text-align:center;border-bottom:1px solid #eee}.table-wrapper[_ngcontent-%COMP%]   .order-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(1), .table-wrapper[_ngcontent-%COMP%]   .order-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(4){text-align:end}.table-wrapper[_ngcontent-%COMP%]   .order-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(1){width:8%;font-weight:600}.table-wrapper[_ngcontent-%COMP%]   .order-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(4){width:10%;font-weight:600}.table-wrapper[_ngcontent-%COMP%]   .order-table[_ngcontent-%COMP%]   .label-cell[_ngcontent-%COMP%]{font-weight:600;text-align:left;background:#f9f9f9}.table-wrapper[_ngcontent-%COMP%]   .order-table[_ngcontent-%COMP%]   .highlight-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background:#eaeaea;font-weight:700}.table-wrapper[_ngcontent-%COMP%]   .order-table[_ngcontent-%COMP%]   .title-cell[_ngcontent-%COMP%]{font-weight:600;text-align:center;margin-right:320px}"]});let o=d;return o})();export{Be as FinalOrderPage};
