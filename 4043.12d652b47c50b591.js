"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4043],{4043:(G,v,s)=>{s.r(v),s.d(v,{HomePageModule:()=>j});var m=s(177),l=s(9417),h=s(8974),u=s(466),g=s(467),e=s(7705),p=s(7376),f=s(6868),_=s(2342),S=s(9030),b=s(7673),T=s(3871);let P=(()=>{var o;class a{constructor(t,r){this.commonService=t,this.utilService=r}getHomeData(t){var r=this;if(this.utilService.isOnline)return this.commonService.get("/home-data/"+t);try{return(0,S.v)((0,g.A)(function*(){return yield r.utilService.getStorageData("homeData")}))}catch{return(0,b.of)([])}}}return(o=a).\u0275fac=function(t){return new(t||o)(e.KVO(T.h),e.KVO(_.a))},o.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"}),a})();var O=s(6241),I=s(9381),D=s(1765),x=s(7487);function C(o,a){if(1&o&&(e.j41(0,"span"),e.EFF(1),e.nrm(2,"br"),e.k0s()),2&o){const i=a.$implicit;e.R7$(1),e.SpI(" ",i,"")}}function X(o,a){if(1&o){const i=e.RV6();e.j41(0,"div",19)(1,"div",20)(2,"div",21),e.bIt("click",function(){const n=e.eBV(i).$implicit,c=e.XpG(2);return e.Njj(c.goToDetail(n))}),e.k0s(),e.j41(3,"div",22)(4,"h6")(5,"a",23),e.DNE(6,C,3,1,"span",24),e.k0s()(),e.j41(7,"h5",25),e.EFF(8),e.k0s()()()()}if(2&o){const i=a.$implicit,t=e.XpG(2);e.R7$(2),e.xc7("background",i.O_XITMIMG?t.utilService.getImageSrc(i.O_XITMIMG,"url"):""),e.R7$(4),e.Y8G("ngForOf",t.utilService.getChunks(i.O_XITMDES)),e.R7$(2),e.SpI(" ",t.utilService.truncateToTwoDecimals(i.O_XNETPRI1)," USD ")}}function M(o,a){if(1&o&&(e.j41(0,"span"),e.EFF(1),e.nrm(2,"br"),e.k0s()),2&o){const i=a.$implicit;e.R7$(1),e.SpI(" ",i,"")}}function F(o,a){if(1&o){const i=e.RV6();e.j41(0,"div",19)(1,"div",20)(2,"div",21),e.bIt("click",function(){const n=e.eBV(i).$implicit,c=e.XpG(2);return e.Njj(c.goToDetail(n))}),e.k0s(),e.j41(3,"div",22)(4,"h6")(5,"a",23),e.DNE(6,M,3,1,"span",24),e.k0s()(),e.j41(7,"h5",25),e.EFF(8),e.k0s()()()()}if(2&o){const i=a.$implicit,t=e.XpG(2);e.R7$(2),e.xc7("background",i.O_XITMIMG?t.utilService.getImageSrc(i.O_XITMIMG,"url"):""),e.R7$(4),e.Y8G("ngForOf",t.utilService.getChunks(i.O_XITMDES1)),e.R7$(2),e.SpI(" ",t.utilService.truncateToTwoDecimals(i.O_XNETPRI1)," USD")}}function N(o,a){if(1&o){const i=e.RV6();e.j41(0,"ion-content"),e.nrm(1,"app-header"),e.j41(2,"section",1)(3,"div",2)(4,"div",3)(5,"div",4),e.nrm(6,"app-categories"),e.k0s(),e.j41(7,"div",5)(8,"div",6)(9,"div",7)(10,"form",8),e.bIt("ngSubmit",function(){e.eBV(i);const r=e.XpG();return e.Njj(r.searchGlobal())}),e.j41(11,"input",9),e.bIt("ngModelChange",function(r){e.eBV(i);const n=e.XpG();return e.Njj(n.globalSearchValue=r)}),e.k0s(),e.j41(12,"button",10),e.EFF(13,"SEARCH"),e.k0s()()()(),e.j41(14,"div",11),e.nrm(15,"div",12),e.k0s()()()()(),e.j41(16,"section",13)(17,"div",2)(18,"div",3)(19,"div",14)(20,"div",15)(21,"h2"),e.EFF(22,"Top Sales"),e.k0s()()()(),e.j41(23,"div",16),e.DNE(24,X,9,4,"div",17),e.k0s()()(),e.j41(25,"section",18)(26,"div",2)(27,"div",3)(28,"div",14)(29,"div",15)(30,"h2"),e.EFF(31,"Recent Products"),e.k0s()()()(),e.j41(32,"div",16),e.DNE(33,F,9,4,"div",17),e.k0s()()(),e.nrm(34,"app-footer"),e.k0s()}if(2&o){const i=e.XpG();e.R7$(11),e.Y8G("ngModel",i.globalSearchValue),e.R7$(13),e.Y8G("ngForOf",i.homeData.topSales),e.R7$(9),e.Y8G("ngForOf",i.homeData.recentProducts)}}const R=[{path:"",component:(()=>{var o;class a{constructor(t,r,n,c,d){this.utilService=t,this.homeService=r,this.productService=n,this.router=c,this.activeRouter=d,this.cartService=(0,e.WQX)(f.m),this.productList=[],this.topSales=[],this.latestProduct=[],this.globalSearchValue=""}ngOnInit(){this.activeRouter.params.subscribe(t=>{this.getHomeData()}),this.userDetail=JSON.parse(localStorage.getItem("userDetail")),this.utilService.getStorageDataByKey("allproductlist").subscribe(t=>{t&&(this.productList=t,this.productFilter())}),this.getCartProducts()}searchGlobal(){this.globalSearchValue&&this.router.navigate(["/shop"],{queryParams:{search:this.globalSearchValue,category:"All",filter:"all",sort:"all"}}).then(()=>{this.globalSearchValue=""})}getHomeData(){var t=this;return(0,g.A)(function*(){yield t.utilService.showLoading(),t.homeService.getHomeData(t.userDetail.O_XCUST).subscribe({next:r=>{t.utilService.dismissLoading(),t.utilService.setStorageData("homeData",r.data);const n={...r.data};n.recentProducts&&(n.recentProducts=t.getLatestUniqueProducts(n.recentProducts)),t.homeData=n},error:r=>{t.utilService.dismissLoading(),t.utilService.showErrorCall(r)}})})()}getLatestUniqueProducts(t){return t.reduce((r,n)=>{const c=r.find(d=>d.O_XITMREF===n.O_XITMREF);if(c){const d=new Date(c.O_XCREDAT);if(new Date(n.O_XCREDAT)>d){const y=r.indexOf(c);r[y]=n}}else r.push(n);return r},[])}getProducts(){var t=this;return(0,g.A)(function*(){yield t.utilService.showLoading(),t.productService.getProducts({code:t.userDetail.O_XCUST}).subscribe(r=>{t.utilService.dismissLoading(),t.productList=r,t.productFilter()},r=>{t.utilService.dismissLoading(),t.utilService.showErrorCall(r)})})()}getCartProducts(){this.cartService.getCart(this.userDetail.I_XBPCNUM,this.userDetail.O_XFCY).subscribe(t=>{const r=[];t.data&&t.data.length>0&&(t.data.forEach(n=>{const c={...r,O_XNETPRI1:Number(n.XNETPRICE1_0).toFixed(2),O_XSAU:n.XUNIT_0,isOpenbtn:!0,qty:n.QUANTITY_0,selectedItem:1,subTotal:Number((Number(n.XNETPRICE1_0)*Number(n.QUANTITY_0)).toFixed(2)),amountTotal:Number((Number(n.XNETPRICE1_0)*Number(n.QUANTITY_0)+Number(n.O_XRATE)*Number(n.QUANTITY_0)).toFixed(2))};r.push(c)}),localStorage.setItem("cartProducts",JSON.stringify(t.data)),this.cartService.selectedCart.next(t.data))})}productFilter(){const t=p.orderBy(this.productList,["O_XSALCOUNT"],["desc"]);this.topSales=t.slice(0,8);const r=p.orderBy(this.productList,["O_XCREDAT"],["desc"]);this.latestProduct=r.slice(0,9)}getBackgroundImage(t){return`url(data:image/jpeg;base64,${t})`}goToDetail(t){this.utilService.isOnline&&this.router.navigate(["/product-detail"],{queryParams:{id:t.O_XITMREF,Type:"home",site:this.userDetail.O_XFCY}})}}return(o=a).\u0275fac=function(t){return new(t||o)(e.rXU(_.a),e.rXU(P),e.rXU(O.b),e.rXU(u.Ix),e.rXU(u.nX))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-home"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"banner","spad"],[1,"container"],[1,"row"],[1,"col-lg-3"],[1,"col-lg-9"],[1,"banner__search"],[1,"banner__search__form"],[3,"ngSubmit"],["type","text","name","search","autocomplete","off","placeholder","What do you need?",3,"ngModel","ngModelChange"],["type","submit",1,"site-btn"],[1,"banner__item","set-bg"],[1,"banner__text"],[1,"featured","spad","pt-4"],[1,"col-lg-12"],[1,"section-title"],[1,"row","featured__filter"],["class","col-lg-3 col-md-4 col-6",4,"ngFor","ngForOf"],[1,"latest-product","spad"],[1,"col-lg-3","col-md-4","col-6"],[1,"featured__item"],[1,"featured__item__pic","border-add","set-bg","cursor-pointer",3,"click"],[1,"featured__item__text"],["href","javascript:void(0);"],[4,"ngFor","ngForOf"],[1,"fs-16"]],template:function(t,r){1&t&&e.DNE(0,N,35,3,"ion-content",0),2&t&&e.Y8G("ngIf",r.homeData)},dependencies:[m.Sq,m.bT,l.qT,l.me,l.BC,l.cb,l.vS,l.cV,h.W9,I.l,D.n,x._],styles:[".tbs-container[_ngcontent-%COMP%]{width:100%;max-width:1140px;margin:0 auto}.border-add[_ngcontent-%COMP%]{border:1px solid #d6d6d6;border-radius:4px}.tbs-navbar[_ngcontent-%COMP%]{padding:.75rem 0;box-shadow:0 .5rem 1rem #00000026,inset 0 -1px #ffffff26;background:var(--ion-color-white);position:sticky;top:0;z-index:1020}.tbs-navbar__nav[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:16px}.tbs-navbar__nav-brand[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;max-height:60px;object-fit:contain}.tbs-navbar__nav-search[_ngcontent-%COMP%]{width:100%;max-width:720px}.primary-btn[_ngcontent-%COMP%]{color:#fff;background:var(--ion-color-primary);height:50px;border-radius:100px;margin:15px}.banner__pic[_ngcontent-%COMP%]{height:200px}"]}),a})()}];let E=(()=>{var o;class a{}return(o=a).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[u.iI.forChild(R),u.iI]}),a})();var H=s(3887);let j=(()=>{var o;class a{}return(o=a).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[m.MD,l.YN,h.bv,E,H.G,l.YN,l.X1]}),a})()}}]);