{"version":3,"sources":["./src/app/ors/ors-routing.module.ts","./src/app/ors/ors.module.ts","./src/app/ors/ors.page.ts","./src/app/ors/ors.page.scss","./src/app/ors/ors.page.html"],"names":[],"mappings":"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","file":"src_app_ors_ors_module_ts.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { OrsPage } from './ors.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: OrsPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class OrsPageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { OrsPageRoutingModule } from './ors-routing.module';\r\n\r\nimport { OrsPage } from './ors.page';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    OrsPageRoutingModule\r\n  ],\r\n  declarations: [OrsPage]\r\n})\r\nexport class OrsPageModule {}\r\n","import { HttpClient } from '@angular/common/http';\r\nimport { Component, OnInit } from '@angular/core';\r\nimport { UtilService } from '../services/util.service';\r\nimport { MAP_STYLES } from '../tabpage/map/map.model';\r\nimport * as moment from 'moment';\r\nimport { RoutesService } from '../services/routes.service';\r\ndeclare var google: any;\r\n\r\n@Component({\r\n  selector: 'app-ors',\r\n  templateUrl: './ors.page.html',\r\n  styleUrls: ['./ors.page.scss'],\r\n})\r\nexport class OrsPage implements OnInit {\r\n  orsResult: any;\r\n  googleMap: any;\r\n  directionsService: any;\r\n  directionsDisplay: any;\r\n\r\n  constructor(\r\n    private http: HttpClient,\r\n    private utilService: UtilService,\r\n    private routeService: RoutesService\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.initMap();\r\n  }\r\n\r\n  initMap() {\r\n    this.directionsService = new google.maps.DirectionsService({\r\n      optimizeWaypoints: true\r\n    });\r\n    this.directionsDisplay = new google.maps.DirectionsRenderer({\r\n      polylineOptions: {\r\n        strokeColor: \"#009e71\",\r\n        strokeWeight: 7,\r\n      }\r\n    });\r\n\r\n    if (!this.googleMap) {\r\n      this.googleMap = new google.maps.Map(document.getElementById('map_canvas'), {\r\n        mapTypeControl: false,\r\n        streetViewControl: false,\r\n        zoom: 10,\r\n        center: { lat: 21.1702, lng: 72.8311 },\r\n        styles: MAP_STYLES,\r\n      });\r\n    }\r\n  }\r\n\r\n  async getRoute() {\r\n    await this.utilService.showLoading();\r\n    this.routeService.oprimizeRoute().subscribe((res: any) => {\r\n      this.utilService.dismissLoading();\r\n      if (res && res.code == 0) {\r\n        this.orsResult = res;\r\n        this.setMarker();\r\n      } else {\r\n        this.utilService.showErrorCall(res);\r\n      }\r\n    }, (err: any) => {\r\n      this.utilService.dismissLoading();\r\n      this.utilService.showErrorCall(err);\r\n    });\r\n  }\r\n\r\n  setMarker() {\r\n    const icon = {\r\n      url: 'assets/images/pin.png',\r\n      labelOrigin: new google.maps.Point(16, 12)\r\n    };\r\n    const homeIcon = 'assets/images/home.png';\r\n    const stops = this.orsResult.routes[0].steps;\r\n    const homearker = new google.maps.Marker({\r\n      position: { lat: Number(stops[0].location[1]), lng: Number(stops[0].location[0]) },\r\n      map: this.googleMap,\r\n      icon: homeIcon,\r\n      label: {\r\n        text: ' ',\r\n        fontSize: \"15px\",\r\n        fontWeight: \"bold\",\r\n        color: '#ffffff',\r\n      },\r\n    });\r\n\r\n    const homeInfoWindow = new google.maps.InfoWindow();\r\n    homeInfoWindow.setContent(\r\n      '<b>Start : ' + moment(new Date(stops[0].arrival * 1000)).format('DD/MM/YYYY hh:mm A') + '</b><br>' +\r\n      '<b>End : ' + moment(new Date(stops[stops.length - 1].arrival * 1000)).format('DD/MM/YYYY hh:mm A') + '</b>'\r\n    );\r\n    homeInfoWindow.open(homearker.getMap(), homearker);\r\n\r\n    stops.map((mt, index) => {\r\n      if (this.googleMap && index != stops.length - 1 && index != 0) {\r\n        const marker = new google.maps.Marker({\r\n          position: { lat: Number(mt.location[1]), lng: Number(mt.location[0]) },\r\n          map: this.googleMap,\r\n          icon: icon,\r\n          label: {\r\n            text: index + '',\r\n            fontSize: \"15px\",\r\n            fontWeight: \"bold\",\r\n            color: '#ffffff',\r\n          },\r\n          title: mt.XBPNAME_0\r\n        });\r\n\r\n        const infoWindow = new google.maps.InfoWindow();\r\n        infoWindow.setContent(\r\n          '<b>Doc Id: ' + mt.id + '</b><br>' +\r\n          '<b>Customer: John Doe</b><br>' +\r\n          '<b>Type: ' + mt.type + '</b><br>' +\r\n          '<b>Arrival : ' + moment(new Date(mt.arrival * 1000)).format('DD/MM/YYYY hh:mm A') + '</b><br>' +\r\n          '<b>Service Time: ' + ((mt.service / 60) | 0) + ' min</b><br>' +\r\n          '<b>Departure : ' + moment(new Date((mt.arrival + mt.service) * 1000)).format('DD/MM/YYYY hh:mm A') + '</b><br>'\r\n        );\r\n        infoWindow.open(marker.getMap(), marker);\r\n      }\r\n      return mt;\r\n    });\r\n\r\n    if (stops && stops.length > 0) {\r\n      const start = stops[0];\r\n      const end = stops[stops.length - 1];\r\n      const waypoints = [];\r\n      for (let i = 1; i < stops.length - 1; i++) {\r\n        waypoints.push({\r\n          location: { lat: stops[i].location[1], lng: stops[i].location[0] }\r\n        });\r\n      }\r\n      let request = {\r\n        origin: { lat: Number(start.location[1]), lng: Number(start.location[0]) },\r\n        waypoints,\r\n        destination: { lat: Number(end.location[1]), lng: Number(end.location[0]) },\r\n        travelMode: google.maps.DirectionsTravelMode.DRIVING\r\n      }\r\n      this.directionsService.route(request, (response, status) => {\r\n        if (status == google.maps.DirectionsStatus.OK) {\r\n          this.directionsDisplay.setDirections(response);\r\n          this.directionsDisplay.setMap(this.googleMap);\r\n          this.directionsDisplay.setOptions({ suppressMarkers: true });\r\n        }\r\n      });\r\n    }\r\n  }\r\n}\r\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJvcnMucGFnZS5zY3NzIn0= */\";","export default \"<ion-content>\\r\\n  <div id=\\\"map_canvas\\\" class=\\\"google-map h-100\\\"></div>\\r\\n</ion-content>\\r\\n\\r\\n<ion-footer>\\r\\n  <ion-toolbar>\\r\\n    <ion-button (click)=\\\"getRoute()\\\" expand=\\\"full\\\">\\r\\n      Get Route\\r\\n    </ion-button>\\r\\n  </ion-toolbar>\\r\\n</ion-footer>\\r\\n\";"],"sourceRoot":"webpack:///"}